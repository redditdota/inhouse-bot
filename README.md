# Dota 2 Inhouse Bot
Creates an inhouse queue and sets up private match for Dota 2

## How to use
* The bot will go through different states these are:
   * closed - no matchmaking queue created or open
   * pre queue - matchmaking queue is created but no lobbies will be created
   * open queue - matches will start but players can still queue again


* Use this command to create the inhouse
```
++inhouse 10 120 15 r/Dota2 Inhouse
```
* This will create message with a reaction which mimics the idea of a matchmaking queue with the following:
  * 10 players per match
  * 15 mins pre queue time (no matches start here)
  * Open queue state for 120 mins and then return to the closed state


* Admins
  * Discord-Mods and Moderators have admin privileges
  * Admins will get notifications in the inhouse moderation channel
  * There is 2 types:
    1. Mod Mail
      * Users can send a message directly to the moderation channel
    2. Match Created
      * Admins must manually create the lobbies with the lobby name and password generated by the bot
      * MSG info:
        * AVG MMR
        * AVG MMR of both sides
        * Teams
        * Captains
        * MMR of every player
        * Lobby name and password


* Casters
  * Admins can set a discord user as a caster
  * casters will get a DM when any match starts
  * DM info:
    * AVG MMR
    * Teams
    * Captains
    * Lobby name and password


* Players
  * players must react to the original message from the bot to be added to the queue
  * when they get picked for a match they will get a DM on the teams and which lobby to join
  * DM info:
     * Their team
     * Teams
     * Captains
     * Lobby name and password


* Linking MMR
 * Players will be kicked from the queue if they don't have their MMR linked
 * Players can link their MMR through OpenDota using their steam32ID
   * e.g. opendota.com/12345678 ++link 1234565678
 * Admins can alternatively set a players mmr manually with this command
   * ++link @user 2500


* More:
  * More matches can be created at anytime in the duration of the 'open queue' state. This allows people to play again after their first match or if they were late.
  * Once the open queue time ends, no more matches can be created








## Road Map


## Future Iterations
* take into account the amount of time someone has been queuing
* ignore mmr
* different lobby sizes for custom games
* give roles to users in a match
  * admin can message all players in a match and tell them to remake
* invite players to match using steamkit
* get results of match
* rules
* move const info to config file
* make sure 2 teams don't generate the same name in the same inhouse

## Features
* Opens a queue
* Links MMR via OpenDota or set by Admins
* Disables players to join unless they have MMR linked
* Players get a notification when their match starts
* Moderators and Casters get notifications when any match starts
* Managing of caster and moderator roles
* Generates a lobby name and password
* Prioritize highest mmr players when enough players to fill multiple lobbies
* Ends the queue

## Setup
You will need NodeJS and to install the following npm modules:
* npm i discord.js
* npm i request
* npm i sqlite

You will also need to create a file called config.json with the following content:
```json
{
  "token":"myAppTokenHere"
}
```
You will also need to set some roles:
* admins
  * the type of users who can use all the bot commands
* inhouse-bot
  * permissions: manage roles and emojis, send and read messages
* inhouse-moderator
  * These users will get notification when the match starts with all the info on MMR and when to create a lobby
* inhouse-caster
  * These users will get a notification when a match starts with the match avg MMR
